<link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
<%= javascript_include_tag 'idangerous_swiper_min.js' -%>

<% if @pagina_especial.url == 'itaucardshows' %>
<script type="text/javascript">
  $(document).ready(function(){
    $('.popup').show();
    if(window.innerWidth >= 500){
      $('body').css('overflow','hidden');
    }
    $('.popup').on('click', function(e){
      e.stopPropagation();
      // window.location.replace(location.protocol+'//'+location.host+"/mariah-carey-the-sweet-sweet-fantasy-tour");
    });
    $('.popup_close').on('click', function(e){
      e.stopPropagation();
      $('body').css('overflow','auto');
      $('.popup').fadeOut(300);
    });
  });
</script>
<% end %>

<style type="text/css">
.popup{
    background:#f1f1f1 url('https://s3-sa-east-1.amazonaws.com/app-passbook/mariah_carey.jpg') center top no-repeat;
  }
::-webkit-input-placeholder {
   color: #000;
   font-style: italic !important;
   font: 12px verdana, arial, sans-serif;
}

:-moz-placeholder {
   color: #000;
   font-style: italic !important;
   font: 12px verdana, arial, sans-serif;
}
  #espetaculos-ausentes{
    width: 100%;
    float: left;
  }     
  .foto_itau{     
    width: 100%;
    height: 220px;
    position: relative;
    padding: 100px 0px;
  }
  .foto_itau .box_texto {
    width: 300px;
    float: right;
    text-align: center;    
  }
  .foto_itau .form-espetaculos-ausentes {
    width: 100%;
  }
  .foto_itau .fonte_laranja_branca {
    float: left;
    margin-left: 10px;
  }
  .foto_itau .conteudo {
    position: absolute;
    width: 960px;
    left: 50%;
    margin-left: -480px;
    float: left;
  }
  .foto_itau .fonte_laranja{
    color: #f47920;
    font-weight: bold;
    font-size: 50px;
    font-family: Arial;
  }
  .foto_itau .fonte_branca{
    color: #ffffff;
    font-size: 25px;
    margin-top: 37px;
  }
  .foto_itau .foto{
    width: 100%;
    height: 100%;
    background-image: url('images/background_eventos_ausentes.jpg');
    background-repeat: no-repeat;
    background-size: 120%;
    background-position: 50% 0%;
    position: absolute;
    top: 8px;
    opacity: 0.8;
    margin: 0px;
    float: none;
  }
  .foto_itau input {
    width: 100%;
    height: 38px;
    padding-left: 24px;
    margin-bottom: 9px;
    border-radius: 4px;
    border: 1px solid #001e59;
    color: #001e59;
    font-weight: bold;
    font-size: 16px;
    font-style: normal;
    box-sizing: border-box;
  }
  .error{
    border:2px solid red !important;
  }
  .foto_itau input[type=submit]{
    background-color: #001e59;
    color:#ffffff;
    text-transform: uppercase;
    width: 140px;
    margin-right: 75px;
    text-align: center;
    padding-left: 0;
    margin: 0 auto;
    display: block;
    transition: all 0.3s;
    cursor: pointer;
  }
  .foto_itau label.privacidade span {
    font-size: 14px;
    color: #ffffff;
    text-shadow: 1px 1px #000000;
  }
  .foto_itau label.resultado span {
    font-size: 14px;
    color: #ffffff;
    text-shadow: 1px 1px #000000;
    margin-bottom: 1em;
    display: block;
  }
  .foto_itau input[name="btn-enviar"]:hover { transition: all 0.3s; background-color: #00AAC0; }

  input[name="espetaculo_ausente[aceita_noticia]"] { height: auto !important; transition: height 0.3s; width: 14px; }
  
  div.separadopor_menor{
    width: 780px !important;
  }
  div.background_pagina{
    background:<%= @pagina_especial.cor_de_fundo %> url('<%= @pagina_especial.imagem.url %>') top center no-repeat;
  }
  div#background_holder div#detalhes_busca{
    background-color:<%= @pagina_especial.cor_de_fundo_do_box %> !important;
  }
  div.background_pagina div#detalhes_busca div.ordem, div.background_pagina div#detalhes_busca p, div.background_pagina div#detalhes_busca div.ordem a.ativo, #espetaculos h1{
    color:<%= @pagina_especial.cor_do_texto_do_box %> !important;
  }
  div.background_pagina div#detalhes_busca div.ordem a{
    color:<%= @pagina_especial.cor_do_link_do_box %>;
  }
  div.background_pagina div#detalhes_busca div.ordem a:hover{
    background-color:<%= @pagina_especial.cor_do_link_do_box %>;
    color:<%= @pagina_especial.cor_do_texto_do_box %>;
  }
  div.card{
    border-color:<%= @pagina_especial.cor_da_borda_do_espetaculo %>;
  }
  #background_holder img.img_header_map{
    display:block;
    height:<%= @pagina_especial.altura_de_inicio_da_listagem %>px;
  }
  div.menu_busca.pag_especial{
    background-color:<%= @pagina_especial.cor_de_fundo_do_box %>;
    width:947px;
    top: 92px;
    top:<%# @pagina_especial.altura_de_inicio_da_listagem+220 %>px;
  }
  div.menu_busca.pag_especial a{
    color:<%= @pagina_especial.cor_do_link_do_box %>;
  }
  div.menu_busca.pag_especial a:hover{
    color:<%= @pagina_especial.cor_do_texto_do_box %>;
    background-color:<%= @pagina_especial.cor_do_link_do_box %>;
  }
  div.background_pagina div.menu_busca.pag_especial{
    border:0;
  }
  div.background_pagina div.menu_busca a{
    font-size:14px;
    margin:0 5px 4px;
  }
  div#menu_topo div.container_mini_cabecalho.linha.fixed{
    position:absolute !important;
    border:0 !important;
    top:56px !important;
  }
  div#menu_topo div.container_mini_cabecalho.linha.fixed.pag_especial{
    top:231px !important;
  }
  .pag_especial_filtros div#busca div.container p{
    color:<%= @pagina_especial.cor_do_link_do_box %> !important;
  }
  .pag_especial_filtros div#busca div.container p.help{
    color:<%= @pagina_especial.cor_do_texto_do_box %> !important;
  }
  div.menu_busca .centraliza{
    width:947px;
  }
  .pag_especial_filtros div#busca{
    width:<%=@tt%>px;
  }
  .pag_especial_filtros div#busca div.container.buscar input {
    width: <%=@tt==360 ? '301':'165'%>px;
  }
  #display{
    height:368px;
    border:0;
  }
  /* CONDITIONAL STYLES */
<% if @pagina_especial.nome_tamanho_da_fonte? -%>
  div.background_pagina div#detalhes_busca div.detalhes p.nome{
    font-size:<%= @pagina_especial.nome_tamanho_da_fonte %>px;
  }
<% end -%>
<% if @tt==360 -%>
  .pag_especial_filtros div#busca div.container.buscar{
    width:<%=@tt%>px;
  }
<% end -%>
<% if @tt>0 -%>
  div.background_pagina div#detalhes_busca div.detalhes{
    height:80px;
  }
  div.background_pagina div#detalhes_busca div.detalhes p.nome{
    margin-top:14px;
  }
<% end -%>
<% if @pagina_especial.mapeamento_de_imagem.blank? and @pagina_especial.url != "theatromunicipaldesaopaulo" -%>
  div#background_holder div#detalhes_busca{
    margin-top:<%= @pagina_especial.altura_de_inicio_da_listagem %>px !important;
  }
<% end -%>
<% if @pagina_especial.link_do_regulamento? -%>
  .link_do_regulamento {
    margin: 10px 0;
    display: block;
    color: <%=@pagina_especial.cor_de_link_do_regulamento -%>
  }
<% end -%>


  /* MOBILE STYLES */

  @media only screen and (min-width:641px) and (max-width:959px){
  .foto_itau .foto {
    background-size: 170%;
    }
  .foto_itau .conteudo {
    width: 650px;
    margin-left: -325px;
    }
  .foto_itau .fonte_laranja {
    font-size: 35px;
    }
  .foto_itau .box_texto {
    width: 230px;
    text-align: center;
    margin-right: 10px;
    }
  }

  @media only screen and (max-width:640px){
    .foto_itau {
      margin: 0 auto;
      padding: 0px !important;
      height: 430px;
    }
    .foto_itau .foto {
      margin: 0px;
      float: none;
    }
    .foto_itau .conteudo {
      margin: 0 auto;
      float: none;
      left: 0px;
      width: 100%;
    }
    .foto_itau .box_texto {
      padding: 6px;
      float: none;
      margin: 0 auto;
      text-align: center;
    }
    .foto_itau .fonte_laranja_branca {
      margin: 0px;
      float:none;
    }
    .foto_itau .fonte_branca {
      font-size: 20px;
      text-align: center;
      margin-top: 10px;
    }
    .foto_itau .fonte_laranja {
      font-size: 35px;
      text-align: center;
      padding-top: 2px;
    }
    div.menu_busca .centraliza, div.menu_busca.pag_especial{
      width:320px;
    }
    div#menu_topo div.container_mini_cabecalho.linha.fixed{
      position:absolute !important;
      border:0 !important;
      top:0px !important;
    }
    div#menu_topo div.container_mini_cabecalho.linha.fixed.pag_especial{
      top:0px !important;
    }
    div.background_pagina div#detalhes_busca div.detalhes{
      height:56px;
    }
    .pag_especial_filtros{
      width:100%;
    }
    .pag_especial_filtros div#busca{
      width:100%;
      margin-top:10px;
    }
    div#busca form{
      display:block;
    }
    div.menu_busca.pag_especial .centraliza{
      float:left;
    }
    div.menu_busca.pag_especial{
      top:<%= @pagina_especial.altura_de_inicio_da_listagem_mobile+247 %>px !important;
    }
    .pag_especial_filtros div#busca div.container.buscar input{
      width:252px;
    }
    .pag_especial_filtros div#busca div.container{
      width:145px !important;
      margin:0 5px;
      text-align:center;
    }
    .pag_especial_filtros div#busca div.container.cidade p, .pag_especial_filtros div#busca div.container.genero p{
      width:145px !important;
    }
    .pag_especial_filtros div#busca div.container.buscar{
      margin-top:7px;
      width:310px !important;
      display:block;
    }
    #background_holder img.img_header_map{
      display:block;
      height:<%= @pagina_especial.altura_de_inicio_da_listagem_mobile %>px;
    }
    #background_holder #display, #background_holder #display #swiper-container, #background_holder #display div, #background_holder #display div a{
      height:156px;
      background-size: auto 156px;
      background-position: 50% top;
    }
    div.separadopor_menor{
      width: 100% !important;
    }
    div.home_module{
      display: none;
    }
    
    /* CONDITIONAL MOBILE STYLES */
<% if @pagina_especial.mapeamento_de_imagem.blank? and @pagina_especial.url != "theatromunicipaldesaopaulo" and (!session[:desktop] or session[:desktop]==0) -%>
    div#background_holder div#detalhes_busca{
      margin-top:<%= @pagina_especial.altura_de_inicio_da_listagem_mobile %>px !important;
    }
<% end -%>
<% if (@pagina_especial.filtro_cidade and !@pagina_especial.filtro_genero) or (!@pagina_especial.filtro_cidade and @pagina_especial.filtro_genero) -%>
    .pag_especial_filtros div#busca div.container{
      width:100px !important;
      margin:0 10px 0 0;
      text-align:center;
    }
    .pag_especial_filtros div#busca div.container.cidade p, .pag_especial_filtros div#busca div.container.genero p{
      width:100px !important;
    }
    .pag_especial_filtros div#busca div.container.buscar{
      margin:0;
    }
    div.menu_busca.pag_especial{
      top:<%= @pagina_especial.altura_de_inicio_da_listagem_mobile+210 %>px !important;
      /* PAGINA NORMAL MOBILE FILTROS OU FILTRO E BUSCA */
    }
    .pag_especial_filtros div#busca div.container.buscar{
      width:200px !important;
    }
    .pag_especial_filtros div#busca div.container.buscar input{
      width:142px;
    }
<% end -%>
<% if !@pagina_especial.filtro_cidade and !@pagina_especial.filtro_genero and @pagina_especial.busca %>
    .pag_especial_filtros div#busca div.container.buscar{
      margin-top:0;
    }
<% end -%>
  div#menu_topo {
      height: 50px !important;
    }
    div#menu_topo a.logo {
      height: 40px;
      background-size:auto 40px;
  }


  /* PAGINA ESPECIAL PRIVADA STYLES */
<% if @pagina_especial.tipo==2 -%>
  div#menu_topo div.bottom div.container_busca{
    margin:0;
    float:right;
    width:<%=@tt%>px;
  }
  div#menu_topo{
    height:70px;
  }
  div#menu_topo div.container_mini_cabecalho{
    top:0;
    background:<%=@pagina_especial.cor_do_header%>;
  }
  div#menu_topo div.container_mini_cabecalho.linha{
    border-bottom-color:<%=@pagina_especial.cor_da_borda_do_header%>;
  }
  div#menu_topo a.logo{
    width:100%;
    height:60px;
    margin:5px 0;
    background-image:url(..<%= @pagina_especial.logo.url %>);
    background-position:center;
    background-size:auto 60px;
  }
  div.menu_busca.pag_especial{
    top:<%= (@pagina_especial.altura_de_inicio_da_listagem)+163 %>px !important;
    /* PAGINA PRIVADA NAO MOBILE */
  }
<% if (@pagina_especial.filtro_cidade and !@pagina_especial.filtro_genero) or (!@pagina_especial.filtro_cidade and @pagina_especial.filtro_genero) -%>
    div.menu_busca.pag_especial{
      top:<%= @pagina_especial.altura_de_inicio_da_listagem_mobile+171 %>px !important;
      /* PAGINA PRIVADA MOBILE FILTROS OU FILTRO E BUSCA */
    }
<% elsif @pagina_especial.filtro_cidade and @pagina_especial.filtro_genero and @pagina_especial.busca %>
    div.menu_busca.pag_especial{
      top:<%= @pagina_especial.altura_de_inicio_da_listagem_mobile+208 %>px !important;
      /* PAGINA PRIVADA MOBILE FILTROS E BUSCA */
    }
<% end -%>
  }
<% end -%>

  @media only screen and (max-width:1279px){
   .foto_itau .foto {
    background-image: url('images/background_eventos_ausentes_320px.png');
    background-position: 50% 35%; 
  }
  }
  @media only screen and (max-width:320px){
  .foto_itau {
    height: 480px;  
  }
  .foto_itau .foto{
    background-image: url('images/background_eventos_ausentes_320px.png');
  }
}
</style>
<% if @pagina_especial.url == 'itaucardshows' or @pagina_especial.url == 'itaucardteatro' %>
<div id="display">
  <div class="swiper-container">
    <div class="swiper-wrapper">
      <% if @pagina_especial.url == 'itaucardshows' %>
        <% if @pagina_especial.blank? -%>
          <%= render :partial => 'layouts/visor_destaque', :collection => @visores %>
        <% else -%>
          <%= render :partial => 'layouts/visor_destaque', :collection => @pagina_especial.pagina_especial_visores %>
        <% end -%>
      <% elsif @pagina_especial.url == 'itaucardteatro' %>
        <% if @pagina_especial.blank? -%>
          <%= render :partial => 'layouts/visor_destaque', :collection => @visores %>
        <% else -%>
          <%= render :partial => 'layouts/visor_destaque', :collection => @pagina_especial.pagina_especial_visores %>
        <% end -%>
      <% end %>
    </div>
  </div>
<div class="pagination"></div>
</div>
<script type="text/javascript">
  $(function(){
    var swiperVisor = $('#display .swiper-container').swiper({
      pagination:'.pagination',
      mode:'horizontal',
      speed:300,
      autoplay:6000,
      moveStartThreshold:50,
      loop:true,
      preventLinks:true,
      paginationClickable:true
    });
  })
</script>
<script type="text/javascript">
  function visorMobile(){
    function mobile(){
      if ($('div.swiper-wrapper').length > 0){    
        if (window.innerWidth<=640 && mobileversion==1){
          $('div.swiper-wrapper').children().each(function(){
            /*if($(this).attr('class')=='swiper-slide'){
              $(this).remove();
            }*/
            $(this).children().attr('style', $(this).children().attr('style').replace('.jpg','m.jpg'));
          })
        } else {
          $('div.swiper-wrapper').children().each(function(){
            $(this).children().attr('style', $(this).children().attr('style').replace('m.jpg','.jpg'));
          })
        }
      }
    }
    
    mobile();
    $(window).resize(function(){
      mobile();
    });
  }
  visorMobile();
</script>
<% end %>
<div class="background_pagina relative">
<% if !@pagina_especial.mapeamento_de_imagem.blank? -%>
  <div class="centraliza">
    <map name="header_map">
      <%= @pagina_especial.mapeamento_de_imagem %>
    </map>
    <img src="/images/header_map.png" usemap="#header_map" class="img_header_map" />
  </div>
<% if !session[:desktop] or session[:desktop]==0 -%>
  <script>
    var divisorMd = 3.0;
    mobileMap(divisorMd);
  </script>
<% end -%>
<% end -%>
  <div class="centraliza">
<% if @espetaculos.nil? -%>
    <h1 class="espetaculos_vazio">Ainda não existe nenhum espetáculo vinculado a esta página.</h1>
<% end -%>
    <div id="detalhes_busca">
      <div class="detalhes">
        <p class="nome"><%= @pagina_especial.nome %></p>
        <p class="total">
          <%= pluralize (@m1.size+@m2.size+@m3.size+@m4.size), 'espetáculo encontrado', 'espetáculos encontrados'%>
        </p>
      </div>
      <div class="ordem">
<% if !params[:busca] -%>
        organizado por
        <a href="/<%= @pagina_especial.url %>?<%= "pecidade=#{@pecidade.nome}" if !@pecidade.blank? %><%= "&pegenero=#{@pegenero.nome}" if !@pegenero.blank? %><%= "&filtro=#{@pef.url}" if !params[:filtro].blank? %>&ordem=destaques"<%= "class='ativo'" if params[:ordem]=='destaques' or (params[:ordem].blank? and @pagina_especial.organizado_por==1) %>>destaques</a>
        <a href="/<%= @pagina_especial.url %>?<%= "pecidade=#{@pecidade.nome}" if !@pecidade.blank? %><%= "&pegenero=#{@pegenero.nome}" if !@pegenero.blank? %><%= "&filtro=#{@pef.url}" if !params[:filtro].blank? %>&ordem=alfabetica"<%= "class='ativo'" if params[:ordem]=='alfabetica' or (params[:ordem].blank? and @pagina_especial.organizado_por==2) %>>alfabética</a>
        <a href="/<%= @pagina_especial.url %>?<%= "pecidade=#{@pecidade.nome}" if !@pecidade.blank? %><%= "&pegenero=#{@pegenero.nome}" if !@pegenero.blank? %><%= "&filtro=#{@pef.url}" if !params[:filtro].blank? %>&ordem=data"<%= "class='ativo'" if params[:ordem]=='data' or (params[:ordem].blank? and @pagina_especial.organizado_por==3) %>>próximas apresentações</a>
<% else -%>
          <a href="/<%= @pagina_especial.url %>">ver todos os espetáculos</a>
<% end -%>
      </div>
<% if @pagina_especial.filtro_cidade or @pagina_especial.filtro_genero or @pagina_especial.busca -%>
      <div class="pag_especial_filtros">
        <div id="busca">
<% if @pagina_especial.filtro_cidade -%>
          <div class="container pag_especial cidade">
            <p>cidade</p>
            <p class="help<%=@pecidade.blank? ? '':' ativo'%>"><%=@pecidade.blank? ? 'Escolha sua cidade':@pecidade.nome%></p>
          </div>
<% end -%>
<% if @pagina_especial.filtro_genero -%>
          <div class="container pag_especial genero">
            <p>gênero</p>
            <p class="help<%=@pegenero.blank? ? '':' ativo'%>"><%=@pegenero.blank? ? 'Escolha o gênero':@pegenero.nome%></p>
          </div>
<% end -%>
<% if @pagina_especial.busca -%>
          <form method="get" action="/<%= @pagina_especial.url %>">
            <div class="container buscar">
              <input type="text" value="espetáculo, diretor, teatro, elenco..." onblur="if(this.value=='') this.value='espetáculo, diretor, teatro, elenco...';" onfocus="if(this.value=='espetáculo, diretor, teatro, elenco...') this.value='';" name="busca">
              <input type="submit" class="submit" value="buscar" />
            </div>
          </form>
<% end -%>
        </div>
      </div>
<% end -%>
    </div>
<%
   cid = Cidade.find_by_sql(["SELECT count(t.id) AS total, c.id, c.nome FROM cidades AS c, teatros AS t, espetaculos AS e, espetaculos_pagina_especiais AS epe WHERE t.cidade_id = c.id AND e.teatro_id = t.id AND epe.espetaculo_id = e.id AND e.ativo = 1 AND epe.pagina_especial_id = ? GROUP BY t.cidade_id ORDER BY total DESC",@pagina_especial.id])
   if @pecidade.blank? or params[:pecidade]=='Todas as cidades'
     gen = Genero.find(:all,
                       :select => "count(1) as total, generos.nome",
                       :conditions => "espetaculos.ativo = true",
                       :joins => ["INNER JOIN espetaculos ON espetaculos.genero_id = generos.id",
                                  "INNER JOIN espetaculos_pagina_especiais ON espetaculos_pagina_especiais.espetaculo_id = espetaculos.id AND espetaculos_pagina_especiais.pagina_especial_id = #{@pagina_especial.id}",
                                  @innerjoin],
                       :group => 'generos.id',
                       :order => 'total DESC')
   else
     gen = Genero.find(:all,
                       :select => "count(1) as total, generos.nome",
                       :conditions => ["espetaculos.ativo = 1 AND cidades.nome = ?",@pecidade.nome],
                       :joins => ["INNER JOIN espetaculos ON espetaculos.genero_id = generos.id",
                                  "INNER JOIN teatros ON espetaculos.teatro_id = teatros.id",
                                  "INNER JOIN cidades ON cidades.id = teatros.cidade_id",
                                  "INNER JOIN espetaculos_pagina_especiais ON espetaculos_pagina_especiais.espetaculo_id = espetaculos.id AND espetaculos_pagina_especiais.pagina_especial_id = #{@pagina_especial.id}",
                                  @innerjoin],
                       :group => 'generos.id',
                       :order => 'total DESC')
   end
-%>
    <div class="menu_busca pag_especial container cidade">
      <div class="centraliza">
        <a href="?pecidade=Todas as cidades"<%=" class='ativo'" if params[:pecidade]=='Todas as cidades'%>>Todas as cidades</a>
<% for cidade in cid -%>
          <a href="?pecidade=<%=cidade.nome%><%= "&filtro=#{@pef.url}" if !params[:filtro].blank? %><%= "&ordem=#{lparam(params[:ordem])}" if params[:ordem] %>" class="<%='ativo' if params[:pecidade]==cidade.nome%><%=' negrito' if cidade.total.to_i>=10%>"><%=cidade.nome%><!--<span>(<%=cidade.total%>)</span>--></a>
<% end -%>
      </div>
    </div>
    <div class="menu_busca pag_especial container genero">
      <div class="centraliza">
        <a href="?pecidade=<%= @pecidade.blank? ? 'Todas as cidades':@pecidade.nome %>&pegenero=Todos os gêneros"<%=" class='ativo'" if params[:pegenero]=='Todos os gêneros'%>>Todos os gêneros</a>
<% for genero in gen -%>
          <a href="?<%= "pecidade=#{@pecidade.nome}&" if !@pecidade.blank? %>pegenero=<%=genero.nome%><%= "&filtro=#{@pef.url}" if !params[:filtro].blank? %><%= "&ordem=#{lparam(params[:ordem])}" if params[:ordem] %>" class="<%='ativo' if params[:pegenero]==genero.nome%>"><%=genero.nome%><!--<span>(<%=genero.total%>)</span>--></a>
<% end -%>
      </div>
    </div>
    <div id="espetaculos">
<% if @m1.size>0 -%>
        <div class="separadopor mes1 <%=(@pagina_especial.pagina_especial_banners.length > 0) ? ' separadopor_menor' : '' -%>">
        <h1><%= @m1.size>0 ? l(@m1.first.proximo_horario.data, :format => :mes):'' %></h1>
        <div class="espetaculos">
          <%= render :partial => 'layouts/card_com_auxiliar', :collection => @m1, :locals => {:auxiliar => @pagina_especial} -%>         
        </div>
      </div>
<% end -%>

<% if @pagina_especial.pagina_especial_banners.length > 0 -%>
  <div class="home_module" style="width: 180px;float:right;">
    <div class="container" style="margin-top:32px;position:relative;text-align: center;">
      <% link_exibe = true -%>
      <% for @banner in @pagina_especial.pagina_especial_banners -%>
        <div class="card_banner">
          <a href="<%=(@banner.blank==true ? 'http://':'')+@banner.link%>" target="<%=@banner.blank==true ? '_blank':'_self'%>">
            <%= image_tag @banner.imagem.url %>
          </a>
          <div class="over">
            <%=link_to '', @banner.link, :class => 'botao saiba_mais'%>
          </div>
        </div>
        <% if link_exibe -%>
          <%=link_to @pagina_especial.texto_de_link_do_regulamento, @pagina_especial.link_do_regulamento, :class => 'link_do_regulamento', :target => (@pagina_especial.blank_de_link_do_regulamento==true ? '_blank':'_self') %>
          <% link_exibe = false -%>
        <% end -%>      
      <% end -%>    
    </div>
  </div>
<% end -%>

<% if @m2.size>0 -%>
      <div class="separadopor mes2">
        <h1><%= @m2.size>0 ? l(@m2.first.proximo_horario.data, :format => :mes):'' %></h1>
        <div class="espetaculos">
          <%= render :partial => 'layouts/card_com_auxiliar', :collection => @m2, :locals => {:auxiliar => @pagina_especial} -%>
        </div>
      </div>
<% end -%>
<% if @m3.size>0 -%>
      <div class="separadopor mes3">
        <h1><%= @m3.size>0 ? l(@m3.first.proximo_horario.data, :format => :mes):'' %></h1>
        <div class="espetaculos">
          <%= render :partial => 'layouts/card_com_auxiliar', :collection => @m3, :locals => {:auxiliar => @pagina_especial} -%>
        </div>
      </div>
<% end -%>
<% if @m4.size>0 -%>
      <div class="separadopor mes3">
        <h1>O que vem por aí...</h1>
        <div class="espetaculos">
          <%= render :partial => 'layouts/card_com_auxiliar', :collection => @m4, :locals => {:auxiliar => @pagina_especial} -%>
        </div>
      </div>
<% end -%>
  </div>
  <script type="text/javascript">
    $(document).ready(function(){
      $('.espetaculos').each(function(){
        $(this).masonry({
          columnWidth:0,
          itemSelector:'.card'
        });
      });
      $( "#cidade" ).autocomplete({
        // source: "municipios.json",
        source: function (request, response) {
                  $.getJSON("municipios.json?term=" + request.term, function (data) {
                      response($.map(data, function (value, key) {
                        return {
                          label: value.municipio.label + ' - ' + value.municipio.sigla,
                          value: value.municipio.value
                        };
                      }));
                  });
                },
        minLength: 3,
        select: function( event, ui ) {    
          event.preventDefault();
          $("#cidade_id").val(ui.item.value);
          $("#cidade").val(ui.item.label);
        },
        focus: function( event, ui) {
          event.preventDefault();
          $("#cidade_id").val(ui.item.value);
          $("#cidade").val(ui.item.label);
        }
      });
      $('form[name="form-espetaculos-ausentes"]').on('submit',function(e){
        e.preventDefault();
        $('form[name="form-espetaculos-ausentes"] :input').each(function(){
          $(this).removeClass("error");
        });
        if (validaEspetaculosAusentes()){
          $.ajax({
            method: "POST",
            url: "/espetaculo_ausentes/save",
            data: $('form[name="form-espetaculos-ausentes"]').serialize()
          }).done(function( msg ) {
            $(".resultado span").text("Dados enviados com sucesso!");
          }).fail(function() {
            $(".resultado span").text("Houve um erro ao enviar os dados.");
          });

          // $.get('http://www.faroestudio.com.br/MailChimp.php', {nome: email, email: email, uf: estado});
        }
      });      
    });
    function validaEspetaculosAusentes(){
      var email=$("#espetaculo_ausente_email");
      var artista=$("#espetaculo_ausente_artista");
      var estilo=$("#espetaculo_ausente_estilo");
      var cidade=$("#cidade_id");
      if(email.val()==""){
        $(".resultado span").text("E-mail inválido" + email.val());
        email.addClass("error");
        email.focus();
        return false;
      }
      if(artista.val()==""){
        $(".resultado span").text("Artista inválido");
        artista.addClass("error");
        artista.focus();
        return false;
      }
      if(estilo.val()==""){
        $(".resultado span").text("Estilo inválido");
        estilo.addClass("error");
        estilo.focus();
        return false;
      }
      if(cidade.val()==""){
        $(".resultado span").text("Digite a Cidade e escolha uma opção.");
        cidade.addClass("error");
        cidade.focus();
        return false;
      }
      return true;
    }
    function validaEmail(email){
      var filtro = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
      if(filtro.test(email)){
        return true;
      } else {
        return false;
      }
    }
  </script>
  <script type="text/javascript">
    $(function() {
      $('#espetaculos .card').each(function(){
        $(this).hoverdir(/*{hoverDelay: 50}*/);
      });
    });
  </script>
  <script type="text/javascript">
    var tt = <%= @pagina_especial.altura_de_inicio_da_listagem+220 %>
    $('#guia_espetaculos .aba').on('click',function(){
      if($(this).attr("class") == "aba fechado"){
        $('.menu_busca.pag_especial.cidade, .menu_busca.pag_especial.genero').animate({
          top:(tt+175)+"px"
        },500);
      }else{
        $('.menu_busca.pag_especial.cidade, .menu_busca.pag_especial.genero').animate({
          top:tt+"px"
        },500);
      }
    });
    /* MENU CIDADE */
    if($(".container.pag_especial.cidade")){
      $(".container.pag_especial.cidade").on('click',function(){
        if($('.menu_busca.pag_especial.cidade').css('display')=='block'){
          $('.menu_busca.pag_especial.cidade').slideUp();
        } else {
          function menuBuscaCidadePagEspecial(){
            $('.menu_busca.pag_especial.cidade').slideDown();
            $(".menu_busca.pag_especial.cidade").hover(
                function(){
                  $('.menu_busca.pag_especial.cidade').css('display', 'block');
                },
                function(){
                  $('.menu_busca.pag_especial.cidade').slideUp(150);
                }
            );
          }

          if($('.menu_busca.pag_especial.genero').css('display')=='block'){
            $('.menu_busca.pag_especial.genero').slideUp(150,function(){
              menuBuscaCidadePagEspecial();
            });
          } else {
            menuBuscaCidadePagEspecial();
          }
        }
      });
    }

    /* MENU GENERO */
    if($(".container.pag_especial.genero")){
      $(".container.pag_especial.genero").on('click',function(){
        if($('.menu_busca.pag_especial.genero').css('display')=='block'){
          $('.menu_busca.pag_especial.genero').slideUp();
        } else {
          function menuBuscaGeneroPagEspecial(){
            $('.menu_busca.pag_especial.genero').slideDown();
            $(".menu_busca.pag_especial.genero").hover(
                function(){
                  $('.menu_busca.pag_especial.genero').css('display', 'block');
                },
                function(){
                  $('.menu_busca.pag_especial.genero').slideUp(150);
                }
            );
          }

          if($('.menu_busca.pag_especial.cidade').css('display')=='block'){
            $('.menu_busca.pag_especial.cidade').slideUp(150,function(){
              menuBuscaGeneroPagEspecial();
            });
          } else {
            menuBuscaGeneroPagEspecial();
          }
        }
      });
    }
  </script>  
  
</div>
<div class="cleaner"></div>
<% if @pagina_especial.url == 'itaucardshows' %>
  <!--
    Start of DoubleClick Floodlight Tag: Please do not remove
    Activity name of this tag: Itaucard_Parceiro_CompreIngressoShows
    URL of the webpage where the tag is expected to be placed: http://www.compreingressos.com/itaucardshows
    This tag must be placed between the <body> and </body> tags, as close as possible to the opening tag.
    Creation Date: 04/12/2016
  -->   
  <script type="text/javascript">
    var axel = Math.random() + "";
    var a = axel * 10000000000000;
    document.write('<iframe src="https://4898329.fls.doubleclick.net/activityi;src=4898329;type=itauc000;cat=itauc00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');
  </script>
  <noscript>
    <iframe src="https://4898329.fls.doubleclick.net/activityi;src=4898329;type=itauc000;cat=itauc00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?" width="1" height="1" frameborder="0" style="display:none"></iframe>
  </noscript>
  <!-- End of DoubleClick Floodlight Tag: Please do not remove -->
<% end %> 


<% if @pagina_especial.url == 'itaucardteatro' %>
  <!--
    1Start of DoubleClick Floodlight Tag: Please do not remove
    Activity name of this tag: Itaucard_Parceiro_CompreIngressoTeatro
    URL of the webpage where the tag is expected to be placed: http://www.compreingressos.com/itaucardteatro
    This tag must be placed between the <body> and </body> tags, as close as possible to the opening tag.
    Creation Date: 04/12/2016
  -->
  <script type="text/javascript">
    var axel = Math.random() + "";
    var a = axel * 10000000000000;
    document.write('<iframe src="https://4898329.fls.doubleclick.net/activityi;src=4898329;type=itauc000;cat=itauc000;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');
  </script>
  <noscript>
    <iframe src="https://4898329.fls.doubleclick.net/activityi;src=4898329;type=itauc000;cat=itauc000;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?" width="1" height="1" frameborder="0" style="display:none"></iframe>
  </noscript>
<!-- End of DoubleClick Floodlight Tag: Please do not remove -->
<% end %> 

<% if @pagina_especial.url == 'itaucardshows' %>
<div class="foto_itau">
    <div class="foto"></div>
  <div class="conteudo">
    <div class="fonte_laranja_branca">
    <div class="fonte_laranja">
      <span>Não achou o artista<br> que você gosta? </span>
    </div>
      <div class="fonte_branca">
      <span>Fala para a gente qual é. Assim que<br> ele estiver por aqui, nós te avisamos :)</span>
      </div>
    </div>
    <div class="box_texto">
    <label class="resultado"><span><span/></label>
      <% @espetaculo_ausente = EspetaculoAusente.new %>
      <% form_for(@espetaculo_ausente, :html => {:name => "form-espetaculos-ausentes"}) do |f| %>
        <%= f.error_messages %>  
        <%= f.text_field :email, :placeholder =>"Seu e-mail" %>
        <%= f.text_field :artista, :placeholder =>"Nome do Artista ou Banda" %>
        <%= f.text_field :estilo, :placeholder =>"Seu estilo favorito" %>
        <input type="text" id="cidade" placeholder = "Digite sua cidade" >
        <%= f.text_field :municipio_id, :id =>"cidade_id", :hidden => true %>
        <label class="privacidade">
          <%= f.check_box :aceita_noticia, :checked => true %>
          <span>Aceito receber notícias da compreingressos.</span>
        </label>
        <%= f.submit "Enviar",:name =>'btn-enviar',:id =>"btn-enviar" %>
      <% end %>
      
    </div>
  </div>
</div>
<% end %> 

